# Cloud Run deployment notes

This repository deploys as a single Cloud Run service that serves:
- API routes from `backend/node-app/index.js`
- Frontend static build from `frontend/build`

## Build and deploy with Cloud Build

```bash
gcloud builds submit --config cloudbuild.yaml \
  --substitutions=_SERVICE_NAME=peekaboo-indoor-playground,_REGION=us-west1
```

## Required runtime environment variables (set in Cloud Run)

> Note: deploy uses `--update-env-vars`, so existing variables are preserved.

- `MONGO_URL` (required)
- `JWT_SECRET` (required)
- `CORS_ORIGINS` (recommended)
- `RESEND_API_KEY` (optional but recommended)
- `SENDER_EMAIL` (optional but recommended)
- `DB_NAME` (optional)

## Optional declarative deploy

Replace `PROJECT_ID` in `service.yaml`, then:

```bash
gcloud run services replace service.yaml --region us-west1
```


## Smoke check after deploy

```bash
curl https://<service-url>/api/healthz
```
